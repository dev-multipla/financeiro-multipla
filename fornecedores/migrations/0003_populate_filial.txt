# Generated by Django 5.1.1 on 2025-05-12 14:32

from django.db import migrations

def set_default_filial(apps, schema_editor):
    # Pega os modelos dinamicamente
    Fornecedor = apps.get_model('fornecedores', 'Fornecedor')
    Filial = apps.get_model('empresas', 'Filial')

    # Seleciona uma filial “padrão” — aqui a primeira que encontrar
    default_filial = Filial.objects.first()
    if not default_filial:
        return  # se não houver nenhuma filial, nada a fazer

    # Atualiza todos os fornecedores sem filial atribuída
    Fornecedor.objects.filter(filial__isnull=True).update(filial=default_filial)


class Migration(migrations.Migration):

    dependencies = [
        ('fornecedores', '0002_fornecedor_filial'),
        ('empresas', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(set_default_filial, migrations.RunPython.noop),
    ]
